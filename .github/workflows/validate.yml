name: Validate Signatures

on:
  pull_request:
    paths:
      - 'signatures/**'
  push:
    branches: [ main ]
    paths:
      - 'signatures/**'

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Validate JSON Format
      run: |
        echo "🔍 Validating JSON format..."
        if ! cat signatures/community-signatures.json | jq empty; then
          echo "❌ Invalid JSON format!"
          exit 1
        fi
        echo "✅ JSON format is valid"
        
    - name: Validate Signature Format
      run: |
        echo "🔍 Validating signature format..."
        npm run validate
